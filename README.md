# SaaS Churn予測プロジェクト（BigQuery × SQL × ML）

## 1. プロジェクト概要

本プロジェクトでは、SaaSサブスクリプションデータを用いて、 BigQuery上で
**SQLのみを使用して**
データ分析から機械学習モデル構築までを実装しました。

目的： - SaaSの解約（Churn）パターンを分析する -
データリークを防いだ特徴量設計を行う - BigQuery
MLによるロジスティック回帰モデルを構築する -
モデル結果を評価し、改善点を考察する

------------------------------------------------------------------------

## 2. データ概要

使用データ：SaaS Subscription & Churn Analytics Dataset（Kaggle）

期間：2023-01-01 ～ 2024-12-31\
総サブスクリプション数：約5,000\
解約率：約6.8%

主なテーブル： - users - subscriptions - events

------------------------------------------------------------------------

## 3. データモデリング

CSVデータをBigQueryに取り込み、以下の分析用テーブルを作成しました。

-   saas_curated.users
-   saas_curated.subscriptions
-   saas_curated.events
-   saas_curated.kpi_monthly
-   saas_curated.retention_cohort
-   saas_curated.features_churn_30d

すべてSQLで実装しています。

------------------------------------------------------------------------

## 4. KPI分析・コホート分析

月次KPIとして以下を算出しました：

-   MAU（月間アクティブユーザー）
-   新規ユーザー数
-   解約ユーザー数
-   MAU基準のChurn率

さらに、コホート分析を実施し、
サインアップ月ごとの継続率を算出しました。

------------------------------------------------------------------------

## 5. 特徴量設計

Churn定義：

「as_of_dateの30日以内にサブスクリプションが終了する場合をChurn=1」

データリーク防止のため： - 特徴量は as_of_date 以前のデータのみ使用 -
ラベルは as_of_date 以降30日間で判定

使用特徴量： - events_7d（直近7日利用回数） -
events_30d（直近30日利用回数） - recency_days（最終利用からの経過日数）

------------------------------------------------------------------------

## 6. モデル構築

モデル：ロジスティック回帰（BigQuery ML）

学習データ：as_of_date \<= 2024-06-30\
テストデータ：as_of_date \> 2024-06-30

------------------------------------------------------------------------

## 7. モデル評価結果

ROC-AUC：0.498\
Accuracy：0.883\
Precision：0.0\
Recall：0.0

解約率が約6.8%と低く、クラス不均衡が強いため、
モデルはほぼ「非解約」と予測する結果となりました。

------------------------------------------------------------------------

## 8. 考察

・利用回数系特徴量のみでは解約の分離が困難\
・クラス不均衡対策が未実施\
・契約情報（MRR、プラン種別、業界など）を追加することで改善可能

本結果は、実務におけるSaaS解約予測の難しさを示しています。

------------------------------------------------------------------------

## 9. 今後の改善案

-   契約属性（plan_tier, industry, mrr_amount）の追加
-   クラス不均衡対策（重み付け・閾値調整）
-   非線形モデルの導入（Boosting等）

------------------------------------------------------------------------

## 10. 本プロジェクトで示したスキル

-   BigQueryでのデータモデリング
-   時系列特徴量設計
-   データリーク防止設計
-   SQLのみでの機械学習実装
-   モデル結果の分析と考察
